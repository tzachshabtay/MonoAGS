language: csharp
solution: MonoAGS.sln
matrix:
  include:
    - os: linux
      mono: latest
      env: BUILD_CONFIG=DesktopRelease BUILD_PLATFORM="Any CPU" DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true MSBuildExtensionsPath32=/usr/lib/mono/xbuild
      dist: trusty
      sudo: required
    - os: linux
      mono: latest
      env: BUILD_CONFIG=DesktopRelease BUILD_PLATFORM="Any CPU" DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true MSBuildExtensionsPath32=/usr/lib/mono/xbuild
      dotnet: 1.0.4
      dist: trusty
    - os: linux
      mono: latest
      env: BUILD_CONFIG=DesktopRelease BUILD_PLATFORM="Any CPU" DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true
      dotnet: 2.0.2
      dist: trusty
    - os: osx
      mono: latest
      env: BUILD_CONFIG=DesktopRelease BUILD_PLATFORM="Any CPU" DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true
      dotnet: 1.0.1

install:
  - find /usr -name "*CSharp.targets*"
  - if [ "$SELF_INSTALL" == "true" ]; then sudo sh -c 'echo "deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet-release/ trusty main" > /etc/apt/sources.list.d/dotnetdev.list'; fi
  - if [ "$SELF_INSTALL" == "true" ]; then sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 417A0893; fi
  - if [ "$SELF_INSTALL" == "true" ]; then sudo apt-get update; fi
  - if [ "$SELF_INSTALL" == "true" ]; then sudo apt-get install dotnet-dev-1.0.9 -y; fi
  - nuget install NUnit.Runners -Version 2.6.4 -OutputDirectory testrunner

script:
 - dotnet restore
 - nuget restore MonoAGS.sln
 - xbuild /p:Configuration=$BUILD_CONFIG /p:Platform="$BUILD_PLATFORM" MonoAGS.sln
 - mono ./testrunner/NUnit.Runners.2.6.4/tools/nunit-console.exe ./Source/Tests/bin/Release/Tests.dll
